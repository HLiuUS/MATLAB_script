function k = gradientf1(x)
k = [4*x(1) - 10*x(2) + 10*x(3) - 2*(x(4) - 4)*(4*x(1) - x(2) + x(3) - x(1)*x(4)) + 2*x(2)*x(4) - 2*x(3)*x(4) + 4*x(1)*(x(1)^2 + x(2)^2 + x(3)^2 - 1);
    10*x(2) - 12*x(1) - 14*x(3) + 2*(x(4) - 3)*(x(1) - 3*x(2) + 2*x(3) + x(2)*x(4)) + 2*x(1)*x(4) + 4*x(3)*x(4) + 4*x(2)*(x(1)^2 + x(2)^2 + x(3)^2 - 1);
    12*x(1) - 14*x(2) + 10*x(3) - 2*(x(4) - 3)*(x(1) - 2*x(2) + 3*x(3) - x(3)*x(4)) - 2*x(1)*x(4) + 4*x(2)*x(4) + 4*x(3)*(x(1)^2 + x(2)^2 + x(3)^2 - 1);
    2*x(2)*(x(1) - 3*x(2) + 2*x(3) + x(2)*x(4)) - 2*x(1)*(4*x(1) - x(2) + x(3) - x(1)*x(4)) - 2*x(3)*(x(1) - 2*x(2) + 3*x(3) - x(3)*x(4))];